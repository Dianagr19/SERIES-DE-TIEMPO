################### 15/03/17 ##############

install.packages("forecast") #librerias para hacer proyecciones
install.packages("fpp")
library(forecast)
library(fpp)
library(readxl)
ventas<- read_excel("C://Users//SALA-F14//Downloads//ejemplo3333333.xlsx")
ventas.ts<- ts(ventas, start=c(2010,1), frequency = 12)
plot(ventas.ts, xlab="Tiempo", ylab="Ventas (millones)", main="Serie Temporal")


#### MÉTODO DE LA MEDIA

help("meanf")
meanf(ventas.ts,h=10)
              #  Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95
              # Sep 2014       223.9554 185.4742 262.4365 164.5028 283.4079
              # Oct 2014       223.9554 185.4742 262.4365 164.5028 283.4079  #todos los pronosticos
              #  Nov 2014       223.9554 185.4742 262.4365 164.5028 283.4079  # son igual a la media
              # Dec 2014       223.9554 185.4742 262.4365 164.5028 283.4079   # 223.9554
              #  Jan 2015       223.9554 185.4742 262.4365 164.5028 283.4079
              #  Feb 2015       223.9554 185.4742 262.4365 164.5028 283.4079
              #  Mar 2015       223.9554 185.4742 262.4365 164.5028 283.4079
              #  Apr 2015       223.9554 185.4742 262.4365 164.5028 283.4079
              #  May 2015       223.9554 185.4742 262.4365 164.5028 283.4079
              #  Jun 2015       223.9554 185.4742 262.4365 164.5028 283.4079




############MÉTODO NAIVE

help(naive)
naive(ventas.ts,10)

          #  Point Forecast    Lo 80    Hi 80     Lo 95    Hi 95
          #  Sep 2014          229.5 189.1311 269.8689 167.76113 291.2389
          #  Oct 2014          229.5 172.4098 286.5902 142.18806 316.8119  #Ultimo valor 
          #  Nov 2014          229.5 159.5791 299.4209 122.56515 336.4349  #observado de la
          #  Dec 2014          229.5 148.7623 310.2377 106.02227 352.9777  # estacionalidad
          #  Jan 2015          229.5 139.2325 319.7675  91.44770 367.5523   #229.5
          #  Feb 2015          229.5 130.6169 328.3831  78.27128 380.7287
          #  Mar 2015          229.5 122.6940 336.3060  66.15432 392.8457
          #  Apr 2015          229.5 115.3196 343.6804  54.87612 404.1239
          #  May 2015          229.5 108.3934 350.6066  44.28340 414.7166
          #  Jun 2015          229.5 101.8424 357.1576  34.26456 424.7354
            
        #####Naive estacional, implica que la serie tiene estacionalidad


snaive(ventas.ts, 10)  #serie con estacionalidad
            
         # Point Forecast    Lo 80    Hi 80    Lo 95    Hi 95
        #  Sep 2014          214.5 192.5094 236.4906 180.8683 248.1317
        #  Oct 2014          240.0 218.0094 261.9906 206.3683 273.6317
        #  Nov 2014          285.0 263.0094 306.9906 251.3683 318.6317
        #  Dec 2014          273.0 251.0094 294.9906 239.3683 306.6317
        #  Jan 2015          207.0 185.0094 228.9906 173.3683 240.6317
        #  Feb 2015          204.0 182.0094 225.9906 170.3683 237.6317
        #  Mar 2015          228.0 206.0094 249.9906 194.3683 261.6317
        #  Apr 2015          190.5 168.5094 212.4906 156.8683 224.1317
        #  May 2015          226.5 204.5094 248.4906 192.8683 260.1317
        #  Jun 2015          195.0 173.0094 216.9906 161.3683 228.6317




## Deriva
rwf (ventas.ts,h=10, drift = TRUE)


        #Point Forecast     Lo 80    Hi 80     Lo 95    Hi 95
        #Sep 2014          229.2 188.46090 269.9391 166.89493 291.5051
        #Oct 2014          228.9 170.76481 287.0352 139.98990 317.8101
        #Nov 2014          228.6 156.76632 300.4337 118.73987 338.4601
        #Dec 2014          228.3 144.62917 311.9708 100.33651 356.2635
        #Jan 2015          228.0 133.65018 322.3498  83.70440 372.2956
        #Feb 2015          227.7 123.47274 331.9273  68.29816 387.1018
        #Mar 2015          227.4 113.88742 340.9126  53.79749 401.0025
        #Apr 2015          227.1 104.75932 349.4407  39.99607 414.2039
        #May 2015          226.8  95.99583 357.6042  26.75228 426.8477
        #Jun 2015          226.5  87.53032 365.4697  13.96422 439.0358


ventas.tsp<-
